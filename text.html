<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		.box{
			height: 50px;
			width: 50px;
			background-color: red;
			position: relative;
			border:2px solid blue;
		}
	</style>
</head>
<body>
	<div class="box"></div>
	<script>
		var box = document.querySelector('.box');
		var move = (function (){//动画
			var target_point_x = null,//X轴目标点
			target_point_y = null;//Y轴目标点
			return function ( target,direction,aim_distance ) {
				var temp_target_point;//用来通信的临时目标点
				direction === "left" && (temp_target_point = target_point_x = target_point_x !== null ? target_point_x - aim_distance : target.offsetLeft - aim_distance);
				direction === "right" && (temp_target_point = target_point_x = target_point_x !== null ? target_point_x + aim_distance : target.offsetLeft + aim_distance);
				direction === "top" && (temp_target_point = target_point_y = target_point_y !== null ? target_point_y - aim_distance : target.offsetTop - aim_distance);
				direction === "bottom" && (temp_target_point = target_point_y = target_point_y !== null ? target_point_y + aim_distance : target.offsetTop + aim_distance);
				return function() {
					if( direction === "left" ){
						(target.offsetLeft > temp_target_point) ? (target.style.left = target.offsetLeft - 8 + "px") : (target.style.left = temp_target_point + "px");
					}else if( direction === "right" ){
						(target.offsetLeft < temp_target_point) ? (target.style.left = target.offsetLeft + 8 + "px") : (target.style.left = temp_target_point + "px");
					}else if( direction === "top" ){
						(target.offsetTop > temp_target_point) ? (target.style.top = target.offsetTop - 8 + "px") : (target.style.top = temp_target_point + "px");
					}else if( direction === "bottom" ){
						(target.offsetTop < temp_target_point) ? (target.style.top = target.offsetTop + 8 + "px") : (target.style.top = temp_target_point + "px");
					}
					return temp_target_point;
				}
			}
		})();
		function animation( target,direction,aim_distance ) {
			var queueObj = [];//队列操作
			queueObj.next = function( n_dir,queue_x ) {
				this.push({
					fn:move(target,n_dir,queue_x),
					dir:n_dir,
					last_x:queue_x
				});
				return queueObj;
			}
			return (function() {
				function real(ani,aim,real_dir) {//真正执行动画
					var temp = ani,
					tempArr;
					function fn() {
						if( real_dir === "left" || real_dir === "right" ){
							if( target.offsetLeft !== temp() ){
								requestAnimationFrame(fn);
							}else{
								queueObj[0] && (tempArr = queueObj.shift());

								console.log(tempArr)
								tempArr && real(tempArr.fn,tempArr.last_x,tempArr.dir);
							}
						}else if( real_dir === "top" || real_dir === "bottom" ){
							if( target.offsetTop !== temp() ){
								requestAnimationFrame(fn);
							}else{
								queueObj[0] && (tempArr = queueObj.shift());

								console.log(tempArr)
								tempArr && real(tempArr.fn,tempArr.last_x,tempArr.dir);
							}
						}
					}
					requestAnimationFrame(fn);
				}
				real(move(target,direction,aim_distance),aim_distance,direction);
				return queueObj;
			})();
		}
		animation(box,"right",500)
		.next("bottom",200)
		.next("left",100)
		.next("left",100)
		.next("bottom",200)
		.next("top",400)
	</script>
</body>
</html>